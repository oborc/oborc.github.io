## 数据库

[TOC]

### 事务

事务的4个特性

#### 原子性

一个事务中的所有操作，要么完成，要么不完成，不会在中间的某个点结束

#### 一致性

事务开始前和开始后，数据库的完整性没有被破坏。（数据符合预设规则）

#### 隔离性

允许多个并发事务的读写。防止数据不一致

1. ##### 未提交读

   事务没提交也可以读取。由于事务没提交之前可以回滚，会出现脏读。

2. ##### 读提交

   不可重复读。在并发的时候对统一数据进行操作会出现的。A在B之前进行了提交，B在A提交前和提交后读到的数据不一样。会有不可重复读。A读两次，操作未完成。操作过程中被改。一样的数据结果不一样

3. ##### 可重复读

   在并发中，A一旦开始读取，在A操作未提交之前，B不能对数据进行修改。幻读（insert or delete ）

4. ##### 串行化

   避免幻读。

#### 持久性

事务处理结束后，对数据的修改是永久的，不会丢失。

### 悲观锁、乐观锁、排他锁

#### 悲观锁

​	对数据的修改保持悲观态度。在处理数据的过程中，将数据保持为锁定状态。其他对数据进行的修改或者加锁机制会被等待或者抛出异常。使用排他锁实现。

#### 排他锁

​	加了排他锁就不能再加任何其他锁。加了共享锁可以再加共享锁，不能加排他锁。拥有共享锁可以读取，修改数据，别人可以读取。拥有排他锁，可以读取，修改，别的事务不可以对数据做任何操作。	

#### 乐观锁

​	并不是使用锁来实现。而是在提交数据的时候，对数据进行检查。如果有修改记录（和自己的版本号不一致）则抛出异常或者回滚。

### 索引

